import{objectSpread2 as e,slicedToArray as n,typeof as t,asyncToGenerator as r,regeneratorRuntime as a}from"./_virtual/_rollupPluginBabelHelpers.js";import o from"react";import{incDec as i,remove as c,setArray as u,set as s,empty as l,format as f,pick as d}from"./utils/index.js";var p=function(t,r){switch(r.type){case"SET":for(var a=0,o=Object.entries(r.payload);a<o.length;a++){var l=n(o[a],2),f=l[0],d=l[1];s(t,d,f)}return e({},t);case"AR":var p=r.payload,y=p.key,v=p.data,b=p.position;return u(t,v,y,b),e({},t);case"RA":var m=r.payload,k=m.key,g=m.condition;return c(t,k,g),e({},t);case"II":for(var h=0,j=Object.entries(r.payload);h<j.length;h++){var O=n(j[h],2),S=O[0],A=O[1];i(t,A,S,"inc")}return e({},t);case"DI":for(var V=0,w=Object.entries(r.payload);V<w.length;V++){var E=n(w[V],2),I=E[0],R=E[1];i(t,R,I,"dec")}return e({},t);default:return e({},t)}},y=function(i){var c=new AbortController,u=e({defaultValue:{}},i),s=o.useState(void 0),y=n(s,2),v=y[0],b=y[1],m=o.useReducer(p,u.defaultValue),k=n(m,2),g=k[0],h=k[1],j=o.useState(!1),O=n(j,2),S=O[0],A=O[1],V=o.useMemo((function(){return Object.entries(g).filter((function(e){var t=n(e,1)[0];return!Object.keys(u.defaultValue).includes(t)}))}),[g,u.defaultValue]),w=o.useCallback((function(e,n){h({type:"AR",payload:{key:e,data:n,position:arguments.length>2&&void 0!==arguments[2]?arguments[2]:"start"}})}),[]),E=o.useCallback((function(e){h({type:"RA",payload:{key:e,condition:arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0}})}),[]),I=o.useCallback((function(){Object.assign(u.defaultValue,Object.fromEntries(V.map((function(e){var r,a,o=n(e,2),i=o[0],c=o[1];return[i,(r=t(c),null!==(a={string:"",number:0}[r])&&void 0!==a?a:"")]})))),h({type:"SET",payload:u.defaultValue})}),[V,u.defaultValue]),R=function(){var n=r(a().mark((function n(t){var r,o,i;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=e({scenario:v,service:function(e){},onSuccess:function(e){},onError:function(e){},onAlways:function(){}},t),n.prev=1,A(!0),o={ctr:c,scenario:r.scenario,data:T,keys:C},n.next=6,r.service(o);case 6:i=n.sent,r.onSuccess(i),n.next=13;break;case 10:n.prev=10,n.t0=n.catch(1),r.onError(n.t0);case 13:return n.prev=13,A(!1),r.onAlways(),n.finish(13);case 17:case"end":return n.stop()}}),n,null,[[1,10,13,17]])})));return function(e){return n.apply(this,arguments)}}(),x=o.useCallback((function(e,n){return e.split(".").reduce((function(e,n){var t=e[n];return t||""}),g)||n||""}),[g]),C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return e&&!i.scenario?[]:"string"==typeof e&&e in i.scenario?[{name:e,keys:i.scenario[e]}]:"boolean"==typeof e&&e?Object.entries(i.scenario).map((function(e){var t=n(e,2);return{name:t[0],keys:t[1]}})):[{name:"default",keys:Object.keys(g||{})}]},T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return"boolean"==typeof e&&e?g:"string"==typeof e&&null!=i&&i.scenario&&e in i.scenario?d(g,i.scenario[e]||[]):g};return{scenario:v,processing:S,data:T,cancel:function(){c.abort()},setData:function(e){if(u.format&&!l(u.format))for(var t=0,r=Object.entries(e);t<r.length;t++){var a=n(r[t],2),o=a[0],i=a[1];f(e,u.format,i,o,g)}h({type:"SET",payload:e})},increment:function(e){h({type:"II",payload:e})},decrement:function(e){h({type:"DI",payload:e})},add:w,remove:E,value:x,reset:I,send:R,keys:C,setScenario:function(e){b(e)}}};export{y as default};
