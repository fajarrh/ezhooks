import{objectSpread2 as e,slicedToArray as t,typeof as n,asyncToGenerator as r,regeneratorRuntime as a}from"./_virtual/_rollupPluginBabelHelpers.js";import o from"react";import{incDec as i,remove as c,setArray as u,set as s,empty as l,format as f,pick as d}from"./utils/index.js";var p=function(n,r){switch(r.type){case"SET":for(var a=0,o=Object.entries(r.payload);a<o.length;a++){var l=t(o[a],2),f=l[0],d=l[1];s(n,d,f)}return e({},n);case"ADD_ARRAY":var p=r.payload,y=p.key,v=p.data,m=p.position;return u(n,v,y,m),e({},n);case"REMOVE_ARRAY":var E=r.payload,b=E.key,k=E.condition;return c(n,b,k),e({},n);case"INCREMENT_ITEM":for(var R=0,g=Object.entries(r.payload);R<g.length;R++){var A=t(g[R],2),h=A[0],j=A[1];i(n,j,h,"inc")}return e({},n);case"DECREMENT_ITEM":for(var T=0,O=Object.entries(r.payload);T<O.length;T++){var M=t(O[T],2),_=M[0],C=M[1];i(n,C,_,"dec")}return e({},n);default:return e({},n)}},y=function(i){var c=new AbortController,u=e({defaultValue:{}},i),s=o.useState(void 0),y=t(s,2),v=y[0],m=y[1],E=o.useReducer(p,u.defaultValue),b=t(E,2),k=b[0],R=b[1],g=o.useState(!1),A=t(g,2),h=A[0],j=A[1],T=o.useMemo((function(){return Object.entries(k).filter((function(e){var n=t(e,1)[0];return!Object.keys(u.defaultValue).includes(n)}))}),[k,u.defaultValue]),O=o.useCallback((function(e,t){R({type:"ADD_ARRAY",payload:{key:e,data:t,position:arguments.length>2&&void 0!==arguments[2]?arguments[2]:"start"}})}),[]),M=o.useCallback((function(e){R({type:"REMOVE_ARRAY",payload:{key:e,condition:arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0}})}),[]),_=o.useCallback((function(){Object.assign(u.defaultValue,Object.fromEntries(T.map((function(e){var r,a,o=t(e,2),i=o[0],c=o[1];return[i,(r=n(c),null!==(a={string:"",number:0}[r])&&void 0!==a?a:"")]})))),R({type:"SET",payload:u.defaultValue})}),[T,u.defaultValue]),C=function(){var t=r(a().mark((function t(n){var r,o,i;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e({scenario:v,service:function(e){},onSuccess:function(e){},onError:function(e){},onAlways:function(){}},n),t.prev=1,j(!0),o={ctr:c,scenario:r.scenario,data:I,keys:V},t.next=6,r.service(o);case 6:i=t.sent,r.onSuccess(i),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(1),r.onError(t.t0);case 13:return t.prev=13,j(!1),r.onAlways(),t.finish(13);case 17:case"end":return t.stop()}}),t,null,[[1,10,13,17]])})));return function(e){return t.apply(this,arguments)}}(),S=o.useCallback((function(e,t){return e.split(".").reduce((function(e,t){var n=e[t];return n||""}),k)||t||""}),[k]),V=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return e&&!i.scenario?[]:"string"==typeof e&&e in i.scenario?[{name:e,keys:i.scenario[e]}]:"boolean"==typeof e&&e?Object.entries(i.scenario).map((function(e){var n=t(e,2);return{name:n[0],keys:n[1]}})):[{name:"default",keys:Object.keys(k||{})}]},I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return"boolean"==typeof e&&e?k:"string"==typeof e&&null!=i&&i.scenario&&e in i.scenario?d(k,i.scenario[e]||[]):k};return{scenario:v,processing:h,data:I,cancel:function(){c.abort()},setData:function(e){if(u.format&&!l(u.format))for(var n=0,r=Object.entries(e);n<r.length;n++){var a=t(r[n],2),o=a[0],i=a[1];f(e,u.format,i,o,k)}R({type:"SET",payload:e})},increment:function(e){R({type:"INCREMENT_ITEM",payload:e})},decrement:function(e){R({type:"DECREMENT_ITEM",payload:e})},addItem:O,removeItem:M,value:S,reset:_,send:C,keys:V,setScenario:function(e){m(e)}}};export{y as default};
