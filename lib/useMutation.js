import{objectSpread2 as e,slicedToArray as n,typeof as t,asyncToGenerator as r,regeneratorRuntime as a}from"./_virtual/_rollupPluginBabelHelpers.js";import o from"react";import{incDec as i,remove as c,setArray as u,set as s,empty as l,format as f,pick as d}from"./utils/index.js";var p=function(t,r){switch(r.type){case"SET":for(var a=0,o=Object.entries(r.payload);a<o.length;a++){var l=n(o[a],2),f=l[0],d=l[1];s(t,d,f)}return e({},t);case"ADD_ARRAY":var p=r.payload,y=p.key,v=p.data,E=p.position;return u(t,v,y,E),e({},t);case"REMOVE_ARRAY":var b=r.payload,m=b.key,k=b.condition;return c(t,m,k),e({},t);case"INCREMENT_ITEM":for(var R=0,g=Object.entries(r.payload);R<g.length;R++){var A=n(g[R],2),h=A[0],j=A[1];i(t,j,h,"inc")}return e({},t);case"DECREMENT_ITEM":for(var T=0,O=Object.entries(r.payload);T<O.length;T++){var M=n(O[T],2),_=M[0],C=M[1];i(t,C,_,"dec")}return e({},t);default:return e({},t)}},y=function(i){var c=new AbortController,u=e({defaultValue:{}},i),s=o.useState(void 0),y=n(s,2),v=y[0],E=y[1],b=o.useReducer(p,u.defaultValue),m=n(b,2),k=m[0],R=m[1],g=o.useState(!1),A=n(g,2),h=A[0],j=A[1],T=o.useMemo((function(){return Object.entries(k).filter((function(e){var t=n(e,1)[0];return!Object.keys(u.defaultValue).includes(t)}))}),[k,u.defaultValue]),O=o.useCallback((function(e,n){R({type:"ADD_ARRAY",payload:{key:e,data:n,position:arguments.length>2&&void 0!==arguments[2]?arguments[2]:"start"}})}),[]),M=o.useCallback((function(e){R({type:"REMOVE_ARRAY",payload:{key:e,condition:arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0}})}),[]),_=o.useCallback((function(){Object.assign(u.defaultValue,Object.fromEntries(T.map((function(e){var r,a,o=n(e,2),i=o[0],c=o[1];return[i,(r=t(c),null!==(a={string:"",number:0}[r])&&void 0!==a?a:"")]})))),R({type:"SET",payload:u.defaultValue})}),[T,u.defaultValue]),C=function(){var n=r(a().mark((function n(t){var r,o,i;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=e({scenario:v,service:function(e){},onSuccess:function(e){},onError:function(e){},onAlways:function(){}},t),n.prev=1,j(!0),o={ctr:c,scenario:r.scenario,data:D,keys:V},n.next=6,r.service(o);case 6:i=n.sent,r.onSuccess(i),n.next=13;break;case 10:n.prev=10,n.t0=n.catch(1),r.onError(n.t0);case 13:return n.prev=13,j(!1),r.onAlways(),n.finish(13);case 17:case"end":return n.stop()}}),n,null,[[1,10,13,17]])})));return function(e){return n.apply(this,arguments)}}(),S=o.useCallback((function(e,n){return e.split(".").reduce((function(e,n){var t=e[n];return t||""}),k)||n||""}),[k]),V=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return e&&!i.scenario?[]:"string"==typeof e&&e in i.scenario?[{name:e,keys:i.scenario[e]}]:"boolean"==typeof e&&e?Object.entries(i.scenario).map((function(e){var t=n(e,2);return{name:t[0],keys:t[1]}})):[{name:"default",keys:Object.keys(k||{})}]},D=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return"boolean"==typeof e&&e?k:"string"==typeof e&&null!=i&&i.scenario&&e in i.scenario?d(k,i.scenario[e]||[]):k};return{scenario:v,processing:h,data:D,cancel:function(){c.abort()},setData:function(e){if(u.format&&!l(u.format))for(var t=0,r=Object.entries(e);t<r.length;t++){var a=n(r[t],2),o=a[0],i=a[1];f(e,u.format,i,o,k)}R({type:"SET",payload:e})},increment:function(e){R({type:"INCREMENT_ITEM",payload:e})},decrement:function(e){R({type:"DECREMENT_ITEM",payload:e})},add:O,remove:M,value:S,reset:_,send:C,keys:V,setScenario:function(e){E(e)}}};export{y as default};
